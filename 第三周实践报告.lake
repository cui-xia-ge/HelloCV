<!doctype lake><title>第三周实践报告</title><meta name="doc-version" content="1" /><meta name="viewport" content="fixed" /><meta name="typography" content="classic" /><meta name="paragraphSpacing" content="relax" /><h3 data-lake-id="Lb0Uh" id="Lb0Uh"><span data-lake-id="ub4427b32" id="ub4427b32">1.问题描述</span></h3><p data-lake-id="u720fdbcf" id="u720fdbcf" style="text-indent: 2em"><span data-lake-id="ua14d1934" id="ua14d1934">输入：/home/cxg/Resources/TrafficLight.mp4</span></p><p data-lake-id="u03d33002" id="u03d33002" style="text-indent: 2em"><span data-lake-id="u3b5b37a0" id="u3b5b37a0">程序功能：将输入视频中出现的红灯、绿灯识别并标记。</span></p><p data-lake-id="u37caeba6" id="u37caeba6" style="text-indent: 2em"><span data-lake-id="u7bbb967c" id="u7bbb967c">输出：打上标记后的视频，存到/home/cxg/Resources/result.avi</span></p><h3 data-lake-id="i9uWE" id="i9uWE"><span data-lake-id="ua0585f2a" id="ua0585f2a">2.数据结构与算法设计</span></h3><p data-lake-id="ub556feac" id="ub556feac" style="text-indent: 2em"><strong><span data-lake-id="u8530608c" id="u8530608c">存储结构</span></strong><span data-lake-id="uf3a5bc48" id="uf3a5bc48">：用VideoCapture类型读取并存放输入；Mat类型存放帧frame；VideoWritter类写入输出。</span></p><p data-lake-id="ub7cbf58b" id="ub7cbf58b" style="text-indent: 2em"><strong><span data-lake-id="u7e77e902" id="u7e77e902">关键算法：</span></strong></p><card type="inline" name="codeblock" value="data:%7B%22search%22%3A%22%E9%80%90%E5%B8%A7%E6%A0%87%E8%AE%B0%E5%B9%B6%E5%86%99%E5%85%A5%E6%96%B0%E8%A7%86%E9%A2%91%22%2C%22mode%22%3A%22abap%22%2C%22code%22%3A%22%20while(cap.read(frame))%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20cvtColor(frame%2CfmHSV%2CCOLOR_BGR2HSV)%3B%5Cn%20%20%20%20%20%20%20%20inRange(fmHSV%2Crlower%2Crupper%2Crmask)%3B%5Cn%20%20%20%20%20%20%20%20inRange(fmHSV%2Cglower%2Cgupper%2Cgmask)%3B%5Cn%20%20%20%20%20%20%20%20editFrame(frame%2Crmask%2C%5C%22RED%5C%22%2Cresult)%3B%5Cn%20%20%20%20%20%20%20%20editFrame(frame%2Cgmask%2C%5C%22GREEN%5C%22%2Cresult)%3B%5Cn%20%20%20%20%20%20%20%20result.write(frame)%3B%5Cn%20%20%20%20%7D%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%E9%80%90%E5%B8%A7%E6%A0%87%E8%AE%B0%E5%B9%B6%E5%86%99%E5%85%A5%E6%96%B0%E8%A7%86%E9%A2%91%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22default%22%2C%22customStyle%22%3A%5B%5D%2C%22fontSize%22%3A14%2C%22__spacing%22%3A%22both%22%2C%22__widthMode%22%3A%22normal%22%2C%22id%22%3A%22WI1Ta%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22widthMode%22%3A%22normal%22%7D" hindent="2em"></card><p data-lake-id="u49feb31d" id="u49feb31d" style="text-indent: 2em"><span data-lake-id="u8e9ec209" id="u8e9ec209">其中editFrame为处理frame的函数。伪代码：</span></p><p data-lake-id="u9bd5eb59" id="u9bd5eb59" style="text-indent: 2em; padding-left: 2em"><span data-lake-id="u1a03ab19" id="u1a03ab19">editFrame(frame,mask,&quot;text&quot;){</span></p><p data-lake-id="u0b23c03c" id="u0b23c03c" style="text-indent: 2em; padding-left: 4em"><span data-lake-id="u864300db" id="u864300db">调用findContours生成掩码图像mask的外轮廓集contours；</span></p><p data-lake-id="u0a1732c8" id="u0a1732c8" style="padding-left: 4em; text-indent: 2em"><span data-lake-id="ua643dffe" id="ua643dffe">for(int i=0;i&lt;contours.size();i++)</span></p><p data-lake-id="uf1ae12a5" id="uf1ae12a5" style="padding-left: 4em; text-indent: 2em"><span data-lake-id="uad68ec91" id="uad68ec91">{</span></p><p data-lake-id="u4d222a1b" id="u4d222a1b" style="padding-left: 6em; text-indent: 2em"><span data-lake-id="uefc6cd7e" id="uefc6cd7e">int area=contourArea(contours[i]);</span></p><p data-lake-id="u3ce83443" id="u3ce83443" style="padding-left: 6em; text-indent: 2em"><span data-lake-id="u5af5efba" id="u5af5efba">if(area&gt;=minarea)</span></p><p data-lake-id="u70eda3d1" id="u70eda3d1" style="text-indent: 2em; padding-left: 6em"><span data-lake-id="u0139d182" id="u0139d182">{</span></p><p data-lake-id="u3e78964c" id="u3e78964c" style="text-indent: 2em; padding-left: 8em"><span data-lake-id="uf65da6d2" id="uf65da6d2">用boundingRect生成轮廓最小外接矩形；</span></p><p data-lake-id="u14322518" id="u14322518" style="text-indent: 2em; padding-left: 8em"><span data-lake-id="u135ab443" id="u135ab443">用rectangle、putText等加工frame；</span></p><p data-lake-id="uda9cf835" id="uda9cf835" style="text-indent: 2em; padding-left: 6em"><span data-lake-id="uea541d79" id="uea541d79">}</span></p><p data-lake-id="u58fa7ca4" id="u58fa7ca4" style="padding-left: 4em; text-indent: 2em"><span data-lake-id="ubacc0162" id="ubacc0162">}}</span></p><h3 data-lake-id="Le5xj" id="Le5xj"><span data-lake-id="uab82e210" id="uab82e210">3.程序实现</span></h3><card type="inline" name="codeblock" value="data:%7B%22search%22%3A%22editFrame%EF%BC%9A%E5%A4%84%E7%90%86frame%E7%9A%84%E5%87%BD%E6%95%B0%22%2C%22mode%22%3A%22abap%22%2C%22code%22%3A%22int%20editFrame(Mat%20%26frame%2CMat%20mask%2Cstd%3A%3Astring%20text)%5Cn%7B%5Cn%20%20%20%20std%3A%3Avector%3CVec4i%3E%20h%3B%5Cn%20%20%20%20std%3A%3Avector%3Cstd%3A%3Avector%3CPoint%3E%3E%20contours%3B%5Cn%20%20%20%20findContours(mask%2Ccontours%2Ch%2CRETR_EXTERNAL%2CCHAIN_APPROX_SIMPLE)%3B%5Cn%20%20%20%20for(int%20i%3D0%3Bi%3Ccontours.size()%3Bi%2B%2B)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20int%20area%3DcontourArea(contours%5Bi%5D)%3B%20%5Cn%20%20%20%20%20%20%20%20if(area%3E%3Dminarea)%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20Rect%20find%3DboundingRect(contours%5Bi%5D)%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20rectangle(frame%2Cfind%2CScalar(255%2C0%2C255)%2C3)%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20putText(frame%2Ctext%2CPoint(10%2C50)%2CFONT_HERSHEY_SIMPLEX%2C2%2CScalar(0%2C255%2C255)%2C2)%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%200%3B%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22editFrame%EF%BC%9A%E5%A4%84%E7%90%86frame%E7%9A%84%E5%87%BD%E6%95%B0%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22default%22%2C%22customStyle%22%3A%5B%5D%2C%22fontSize%22%3A14%2C%22__spacing%22%3A%22both%22%2C%22__widthMode%22%3A%22normal%22%2C%22id%22%3A%22n2W1S%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22widthMode%22%3A%22normal%22%7D" hindent="2em"></card><p data-lake-id="u9a04a05a" id="u9a04a05a" style="text-indent: 2em; padding-left: 2em"><span data-lake-id="u9525ffac" id="u9525ffac">text：绘制的文本，预期传入“RED”或“GREEN”</span></p><p data-lake-id="u52835024" id="u52835024" style="text-indent: 2em; padding-left: 2em"><span data-lake-id="u23cc8b76" id="u23cc8b76">mask：输入图像</span></p><p data-lake-id="u9d23eb26" id="u9d23eb26" style="text-indent: 2em; padding-left: 2em"><span data-lake-id="uab537c5f" id="uab537c5f">frame：输出图像</span></p><card type="inline" name="codeblock" value="data:%7B%22search%22%3A%22main%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%22%2C%22mode%22%3A%22abap%22%2C%22code%22%3A%22int%20main()%5Cn%7B%5Cn%20%20%20%20VideoCapture%20cap(%5C%22%2Fhome%2Fcxg%2FResources%2FTrafficLight.mp4%5C%22)%3B%5Cn%20%20%20%20Mat%20frame%2Crmask%2Cgmask%2Cmask%2CfmHSV%2Cfblur%2Crf%3B%5Cn%20%20%20%20if(!cap.isOpened())%5Ct%5Ct%2F%2F%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20std%3A%3Acout%3C%3C%5C%22readfailure%5C%5Cn%5C%22%3B%5Cn%20%20%20%20%20%20%20%20return%201%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20Scalar%20rlower(175%2C110%2C55)%3B%5Ct%2F%2F%E5%AE%9A%E4%B9%89inRange%E6%89%80%E9%9C%80%E7%9A%84%E4%B8%8A%E4%B8%8B%E7%95%8C%5Cn%20%20%20%20Scalar%20rupper(179%2C230%2C255)%3B%5Cn%20%20%20%20Scalar%20glower(79%2C187%2C140)%3B%5Cn%20%20%20%20Scalar%20gupper(89%2C252%2C214)%3B%5Cn%20%20%20%20VideoWriter%20result(%5C%22%2Fhome%2Fcxg%2FResources%2Fresult.avi%5C%22%2Ccv%3A%3AVideoWriter%3A%3Afourcc('X'%2C'2'%2C'6'%2C'4')%2Ccap.get(CAP_PROP_FPS)%2CSize(cap.get(CAP_PROP_FRAME_WIDTH)%2Ccap.get(CAP_PROP_FRAME_HEIGHT)))%3B%5Cn%20%20%20%20while(cap.read(frame))%5Ct%5Ct%2F%2F%E5%BE%AA%E7%8E%AF%E9%80%90%E5%B8%A7%E6%93%8D%E4%BD%9C%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20cvtColor(frame%2CfmHSV%2CCOLOR_BGR2HSV)%3B%5Cn%20%20%20%20%20%20%20%20inRange(fmHSV%2Crlower%2Crupper%2Crmask)%3B%5Cn%20%20%20%20%20%20%20%20inRange(fmHSV%2Cglower%2Cgupper%2Cgmask)%3B%5Cn%20%20%20%20%20%20%20%20editFrame(frame%2Crmask%2C%5C%22RED%5C%22)%3B%5Ct%2F%2F%E6%A3%80%E6%B5%8B%E3%80%81%E5%8A%A0%E5%B7%A5frame%5Cn%20%20%20%20%20%20%20%20editFrame(frame%2Cgmask%2C%5C%22GREEN%5C%22)%3B%5Cn%20%20%20%20%20%20%20%20result.write(frame)%3B%5Ct%5Ct%2F%2F%E9%80%90%E5%B8%A7%E5%86%99%E5%85%A5%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%200%3B%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22main%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22default%22%2C%22customStyle%22%3A%5B%5D%2C%22fontSize%22%3A14%2C%22__spacing%22%3A%22both%22%2C%22__widthMode%22%3A%22normal%22%2C%22id%22%3A%22DoKZO%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22widthMode%22%3A%22normal%22%7D" hindent="2em"></card><h3 data-lake-id="LpVgt" id="LpVgt"><span data-lake-id="u589fada8" id="u589fada8">4.实验过程&amp;结果</span></h3><h4 data-lake-id="F5Z4I" id="F5Z4I"><span data-lake-id="ue8f8042a" id="ue8f8042a">调试方法：</span></h4><p data-lake-id="u8d6c8cb8" id="u8d6c8cb8"><strong><span data-lake-id="ue6d59487" id="ue6d59487">首先需要获得inRange所需阈值范围。</span></strong></p><p data-lake-id="u76dbaf65" id="u76dbaf65"><span data-lake-id="u39cc12db" id="u39cc12db">先创建Trackbar交互式窗口：</span></p><card type="inline" name="codeblock" value="data:%7B%22search%22%3A%22%E8%B0%83%E8%AF%95%E4%BB%A3%E7%A0%81%22%2C%22mode%22%3A%22abap%22%2C%22code%22%3A%22int%20hmin%2Csmin%2Cvmin%2Csmax%2Chmax%2Cvmax%3B%5CnnamedWindow(%5C%22Trackbars%5C%22)%3B%5CncreateTrackbar(%5C%22Hmin%5C%22%2C%20%5C%22Trackbars%5C%22%2C%20%26hmin%2C179)%3B%5CncreateTrackbar(%5C%22Hmax%5C%22%2C%20%5C%22Trackbars%5C%22%2C%20%26hmax%2C179)%3B%5CncreateTrackbar(%5C%22Smin%5C%22%2C%20%5C%22Trackbars%5C%22%2C%20%26smin%2C255)%3B%20%20%5CncreateTrackbar(%5C%22Smax%5C%22%2C%20%5C%22Trackbars%5C%22%2C%20%26smax%2C255)%3B%5CncreateTrackbar(%5C%22Vmin%5C%22%2C%20%5C%22Trackbars%5C%22%2C%20%26vmin%2C255)%3B%5CncreateTrackbar(%5C%22Vmax%5C%22%2C%20%5C%22Trackbars%5C%22%2C%20%26vmax%2C255)%3B%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Atrue%2C%22name%22%3A%22%E8%B0%83%E8%AF%95%E4%BB%A3%E7%A0%81%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22default%22%2C%22customStyle%22%3A%5B%5D%2C%22fontSize%22%3A14%2C%22__spacing%22%3A%22both%22%2C%22__widthMode%22%3A%22normal%22%2C%22id%22%3A%22xMt0o%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22widthMode%22%3A%22normal%22%7D"></card><p data-lake-id="uc64d6891" id="uc64d6891"><span data-lake-id="u17245883" id="u17245883">用一个循环逐帧播放原视频，输入“q”时退出循环，便于在特定帧调试阈值。</span></p><card type="inline" name="codeblock" value="data:%7B%22search%22%3A%22%22%2C%22mode%22%3A%22abap%22%2C%22code%22%3A%22while(cap.read(frame))%7B%5Cn%20%20%20%20resize(frame%2Crf%2CSize()%2C0.5%2C0.5)%3B%5Cn%20%20%20%20cvtColor(rf%2CfmHSV%2CCOLOR_BGR2HSV)%3B%5Cn%20%20%20%20imshow(%5C%22H%5C%22%2CfmHSV)%3B%5Cn%20%20%20%20if(waitKey(20)%3D%3D'q')%5Cn%20%20%20%20%20%20%20%20%20%20break%3B%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Atrue%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22default%22%2C%22customStyle%22%3A%5B%5D%2C%22fontSize%22%3A14%2C%22__spacing%22%3A%22both%22%2C%22__widthMode%22%3A%22normal%22%2C%22id%22%3A%22vQ6hn%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22widthMode%22%3A%22normal%22%7D"></card><p data-lake-id="u7626d31f" id="u7626d31f"><span data-lake-id="u64667cda" id="u64667cda">读取循环结束的下一帧进行调试，分别在红灯、绿灯出现时进行两次调试即可。</span></p><card type="inline" name="codeblock" value="data:%7B%22search%22%3A%22%22%2C%22mode%22%3A%22abap%22%2C%22code%22%3A%22cap.read(frame)%3B%5Cnwhile(1)%7B%5Cn%20%20%20%20Scalar%20lower(hmin%2Csmin%2Cvmin)%3B%5Cn%20%20%20%20Scalar%20upper(hmax%2Csmax%2Cvmax)%3B%5Cn%20%20%20%20resize(frame%2Crf%2CSize()%2C0.5%2C0.5)%3B%5Cn%20%20%20%20cvtColor(rf%2CfmHSV%2CCOLOR_BGR2HSV)%3B%5Cn%20%20%20%20inRange(fmHSV%2Clower%2Cupper%2Cmask)%3B%5Cn%20%20%20%20imshow(%5C%22H%5C%22%2CfmHSV)%3B%5Cn%20%20%20%20imshow(%5C%22mk%5C%22%2Cmask)%3B%5Cn%20%20%20%20waitKey(5)%3B%5Ct%7D%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Atrue%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22default%22%2C%22customStyle%22%3A%5B%5D%2C%22fontSize%22%3A14%2C%22__spacing%22%3A%22both%22%2C%22__widthMode%22%3A%22normal%22%2C%22id%22%3A%22q8Iu4%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22widthMode%22%3A%22normal%22%7D"></card><p data-lake-id="u52f9946a" id="u52f9946a"><span data-lake-id="ufeb9e606" id="ufeb9e606">交互式调试窗口：记录合适的Hmin、Hmax,Smin,Smax,Vmin,Vmax值对主程序中的Scalar rlower、Scalar rupper()、Scalar glower()、Scalar gupper()初始化。</span></p><p data-lake-id="ud122fe53" id="ud122fe53"><card type="inline" name="image" value="data:%7B%22src%22%3A%22https%3A%2F%2Fcdn.nlark.com%2Fyuque%2F0%2F2025%2Fpng%2F57358625%2F1761474830268-40440204-31c6-42d6-9094-f2d6a0bbfe1f.png%22%2C%22taskId%22%3A%22uadfee3b4-a58f-47d9-af35-90bcee4625f%22%2C%22clientId%22%3A%22ufb72355f-5f8a-4%22%2C%22originalType%22%3A%22binary%22%2C%22width%22%3A619.4000244140625%2C%22height%22%3A316%2C%22linkTarget%22%3A%22_blank%22%2C%22name%22%3A%22image.png%22%2C%22size%22%3A62607%2C%22from%22%3A%22paste%22%2C%22originWidth%22%3A1151%2C%22originHeight%22%3A587%2C%22ratio%22%3A1.25%2C%22status%22%3A%22done%22%2C%22style%22%3A%22none%22%2C%22ocrLocations%22%3A%5B%7B%22text%22%3A%22XA-VIRTUAL-M%22%2C%22x%22%3A952%2C%22y%22%3A15%2C%22width%22%3A137%2C%22height%22%3A13%7D%2C%7B%22text%22%3A%22%E5%90%8D%22%2C%22x%22%3A771%2C%22y%22%3A442%2C%22width%22%3A126%2C%22height%22%3A86%7D%2C%7B%22text%22%3A%22IMECO.%22%2C%22x%22%3A486%2C%22y%22%3A45%2C%22width%22%3A90%2C%22height%22%3A19%7D%2C%7B%22text%22%3A%22TRACKBARS%22%2C%22x%22%3A181%2C%22y%22%3A16%2C%22width%22%3A97%2C%22height%22%3A16%7D%2C%7B%22text%22%3A%22MIN%22%2C%22x%22%3A4%2C%22y%22%3A66%2C%22width%22%3A51%2C%22height%22%3A18%7D%2C%7B%22text%22%3A%22CXGOCXG-%22%2C%22x%22%3A881%2C%22y%22%3A16%2C%22width%22%3A109%2C%22height%22%3A13%7D%2C%7B%22text%22%3A%22%22%2C%22x%22%3A768%2C%22y%22%3A296%2C%22width%22%3A81%2C%22height%22%3A-18%7D%2C%7B%22text%22%3A%22%22%2C%22x%22%3Anull%2C%22y%22%3A0%2C%22width%22%3Anull%2C%22height%22%3A265%7D%2C%7B%22text%22%3A%22MAX%22%2C%22x%22%3A8%2C%22y%22%3A369%2C%22width%22%3A48%2C%22height%22%3A15%7D%2C%7B%22text%22%3A%22175%22%2C%22x%22%3A419%2C%22y%22%3A50%2C%22width%22%3A35%2C%22height%22%3A20%7D%2C%7B%22text%22%3A%22179%22%2C%22x%22%3A423%2C%22y%22%3A110%2C%22width%22%3A41%2C%22height%22%3A19%7D%2C%7B%22text%22%3A%22MAX%22%2C%22x%22%3A2%2C%22y%22%3A129%2C%22width%22%3A56%2C%22height%22%3A14%7D%2C%7B%22text%22%3A%22VMIN%22%2C%22x%22%3A1%2C%22y%22%3A309%2C%22width%22%3A52%2C%22height%22%3A15%7D%2C%7B%22text%22%3A%22MIN%22%2C%22x%22%3A2%2C%22y%22%3A188%2C%22width%22%3A50%2C%22height%22%3A16%7D%2C%7B%22text%22%3A%22230%22%2C%22x%22%3A388%2C%22y%22%3A232%2C%22width%22%3A43%2C%22height%22%3A16%7D%2C%7B%22text%22%3A%2255%22%2C%22x%22%3A141%2C%22y%22%3A292%2C%22width%22%3A48%2C%22height%22%3A15%7D%2C%7B%22text%22%3A%22MK%22%2C%22x%22%3A838%2C%22y%22%3A126%2C%22width%22%3A47%2C%22height%22%3A16%7D%2C%7B%22text%22%3A%22MACHIN%22%2C%22x%22%3A1065%2C%22y%22%3A15%2C%22width%22%3A78%2C%22height%22%3A14%7D%2C%7B%22text%22%3A%22255%22%2C%22x%22%3A420%2C%22y%22%3A351%2C%22width%22%3A41%2C%22height%22%3A18%7D%2C%7B%22text%22%3A%22110%22%2C%22x%22%3A226%2C%22y%22%3A171%2C%22width%22%3A40%2C%22height%22%3A16%7D%2C%7B%22text%22%3A%22%E4%B8%AD%22%2C%22x%22%3A616%2C%22y%22%3A13%2C%22width%22%3A28%2C%22height%22%3A18%7D%2C%7B%22text%22%3A%22X%22%2C%22x%22%3A419%2C%22y%22%3A13%2C%22width%22%3A37%2C%22height%22%3A21%7D%2C%7B%22text%22%3A%22%22%2C%22x%22%3A776%2C%22y%22%3A320%2C%22width%22%3A78%2C%22height%22%3A-14%7D%5D%2C%22showTitle%22%3Afalse%2C%22title%22%3A%22%22%2C%22rotation%22%3A0%2C%22crop%22%3A%5B0%2C0%2C1%2C1%5D%2C%22averageHue%22%3A%22%23666564%22%2C%22id%22%3A%22ucc75e9ac%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D"></card></p><p data-lake-id="u161c02b3" id="u161c02b3"><strong><span data-lake-id="u4e29068f" id="u4e29068f">其次需确定minarea的值。</span></strong></p><p data-lake-id="u9036807d" id="u9036807d"><span data-lake-id="u34a73d19" id="u34a73d19">用调试好的inRange生成mask，进一步findContours得到contours</span></p><p data-lake-id="ue691ddd3" id="ue691ddd3"><span data-lake-id="u4743012e" id="u4743012e">循环输出各contour的面积，即可人工看出阈值应设为多少。这里我取了20000。</span></p><card type="inline" name="codeblock" value="data:%7B%22search%22%3A%22%22%2C%22mode%22%3A%22abap%22%2C%22code%22%3A%22for(int%20i%3D0%3Bi%3Ccontours.size()%3Bi%2B%2B)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20int%20area%3DcontourArea(contours%5Bi%5D)%3B%20%5Cn%20%20%20%20%20%20%20%20std%3A%3Acout%3C%3Carea%3C%3Cendl%3B%5Cn%20%20%20%20%7D%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Atrue%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22default%22%2C%22customStyle%22%3A%5B%5D%2C%22fontSize%22%3A14%2C%22__spacing%22%3A%22both%22%2C%22__widthMode%22%3A%22normal%22%2C%22id%22%3A%22czGLr%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22widthMode%22%3A%22normal%22%7D"></card><p data-lake-id="uc36c3883" id="uc36c3883"><strong><span data-lake-id="ud531c6f5" id="ud531c6f5">按上述流程不断调试，最终成功得到预期视频~</span></strong></p><p data-lake-id="u8b561bdf" id="u8b561bdf"><card type="inline" name="image" value="data:%7B%22src%22%3A%22https%3A%2F%2Fcdn.nlark.com%2Fyuque%2F0%2F2025%2Fpng%2F57358625%2F1761497369474-1b8b46d7-6ae7-4469-b180-bd0b293d1d78.png%22%2C%22taskId%22%3A%22u12ca68ca-fd87-46fb-a886-7375d6e2233%22%2C%22clientId%22%3A%22u6619a325-62a8-4%22%2C%22originalType%22%3A%22binary%22%2C%22width%22%3A586.4000244140625%2C%22height%22%3A332%2C%22linkTarget%22%3A%22_blank%22%2C%22name%22%3A%22image.png%22%2C%22size%22%3A657789%2C%22from%22%3A%22paste%22%2C%22originWidth%22%3A1740%2C%22originHeight%22%3A986%2C%22ratio%22%3A1.25%2C%22status%22%3A%22done%22%2C%22style%22%3A%22none%22%2C%22ocrLocations%22%3A%5B%7B%22text%22%3A%22K00%3A00%3A0%22%2C%22x%22%3A50%2C%22y%22%3A949%2C%22width%22%3A240%2C%22height%22%3A30%7D%2C%7B%22text%22%3A%2200%3A00%3A01%22%2C%22x%22%3A421%2C%22y%22%3A948%2C%22width%22%3A147%2C%22height%22%3A31%7D%2C%7B%22text%22%3A%2200%3A00%3A14%22%2C%22x%22%3A1199%2C%22y%22%3A948%2C%22width%22%3A159%2C%22height%22%3A32%7D%2C%7B%22text%22%3A%22%E5%9B%BD%E4%B8%800%22%2C%22x%22%3A1488%2C%22y%22%3A948%2C%22width%22%3A150%2C%22height%22%3A33%7D%2C%7B%22text%22%3A%22)%E5%9B%9E%22%2C%22x%22%3A1605%2C%22y%22%3A947%2C%22width%22%3A123%2C%22height%22%3A37%7D%2C%7B%22text%22%3A%22RESULT.AV%22%2C%22x%22%3A60%2C%22y%22%3A917%2C%22width%22%3A101%2C%22height%22%3A19%7D%2C%7B%22text%22%3A%22E%E5%B7%A5%22%2C%22x%22%3A12%2C%22y%22%3A7%2C%22width%22%3A89%2C%22height%22%3A48%7D%2C%7B%22text%22%3A%22-0%22%2C%22x%22%3A1363%2C%22y%22%3A949%2C%22width%22%3A114%2C%22height%22%3A31%7D%5D%2C%22showTitle%22%3Afalse%2C%22title%22%3A%22%22%2C%22rotation%22%3A0%2C%22crop%22%3A%5B0%2C0%2C1%2C1%5D%2C%22averageHue%22%3A%22%233c3d29%22%2C%22id%22%3A%22uc2d3515b%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D"></card></p><p data-lake-id="u339ccd58" id="u339ccd58"><card type="inline" name="image" value="data:%7B%22src%22%3A%22https%3A%2F%2Fcdn.nlark.com%2Fyuque%2F0%2F2025%2Fpng%2F57358625%2F1761497298188-9848bea0-451c-4527-85bd-4f0fa81332db.png%22%2C%22taskId%22%3A%22u9baafde7-3d09-445f-835b-236ac29365e%22%2C%22clientId%22%3A%22u6619a325-62a8-4%22%2C%22originalType%22%3A%22binary%22%2C%22width%22%3A582.3999938964844%2C%22height%22%3A333%2C%22linkTarget%22%3A%22_blank%22%2C%22name%22%3A%22image.png%22%2C%22size%22%3A659403%2C%22from%22%3A%22paste%22%2C%22originWidth%22%3A1696%2C%22originHeight%22%3A969%2C%22ratio%22%3A1.25%2C%22status%22%3A%22done%22%2C%22style%22%3A%22none%22%2C%22showTitle%22%3Afalse%2C%22title%22%3A%22%22%2C%22rotation%22%3A0%2C%22crop%22%3A%5B0%2C0%2C1%2C1%5D%2C%22averageHue%22%3A%22%2341420b%22%2C%22id%22%3A%22u28bc84b2%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D"></card></p><p data-lake-id="u00e70825" id="u00e70825" style="text-indent: 2em"><strong><span data-lake-id="uce6ad3f4" id="uce6ad3f4">​</span></strong><br></p><p data-lake-id="u84ef9bac" id="u84ef9bac" style="text-indent: 2em"><span data-lake-id="u48939a68" id="u48939a68">​</span><br></p>